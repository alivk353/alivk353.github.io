# 端口扫描技术

## TCP 三次握手


- 客户端向服务器发送一个 SYN (Synchronize) 报文段。客户端进入 SYN_SENT 状态。

    - 标志位 SYN = 1。随机生成一个初始序列号 seq = x。

    - 此时没有确认号（ACK 位为 0）。

- 服务器同意建立连接，向客户端回发一个报文：SYN + ACK 

    - 服务器进入 SYN_RCVD 状态。标志位 SYN = 1 且 ACK = 1。

    - 服务器也随机生成一个自己的初始序列号 seq = y。

    - 确认号 ack = x + 1（表示收到了客户端的 x，希望下次收到 x+1）。

-  客户端发送 ACK 确认握手成功报文

    - 客户端进入ESTABLISHED 状态，服务器收到后也进入 ESTABLISHED 状态。
    - 标志位 ACK = 1。
    - 序列号 seq = x + 1。
    - 确认号 ack = y + 1。

### sS (TCP SYN扫描) 半开放扫描

发送SYN标志位 等待响应SYN + ACK 

### -sT (TCP connect()扫描) 全连接扫描

正常三次握手成功

### -sA (TCP ACK扫描) 区分那些端口是被过滤的

只设置ACK标志位，open(开放的)和closed(关闭的) 端口 都会返回RST报文

### -sU (UDP扫描) 

字面意思，可以和TCP扫描技术同时启用


### -sF FIN扫描 

FIN (Finish) 标志位用于释放连接 是关闭连接TCP的第一个包

只设置TCP FIN标志位。当端口开放会响应RST标志位

### -sN Null扫描 

不设置任何标志位(tcp标志头是0) 当端口开放会响应RST标志位
### -sX Xmas扫描 

设置FIN，PSH，和URG标志位，就像点亮圣诞树上所有的灯一样。